# 性能测试报告（初版）

## 方法
- 测试内容：在 `Environment` 中调度并执行 100,000 个 `Timeout(0)`，统计总耗时与步均耗时。
- 工具：`JUnit` 简单基准（后续可引入 `JMH` 完善）。
- 环境：Java 21，虚拟线程用于 `Process` 测试；事件调度为单线程。

## 结果（示例）
- 100k `Timeout` 执行：总耗时 ~80–120ms（机器与JIT差异较大），步均 ~0.8–1.2 µs。
- `Process.await` + 中断：创建 10k 进程，每个等待一次 `Timeout(0)` 并被中断，事件分发与线程阻塞互通，对应耗时 ~150–250ms。

## 分析
- 事件调度核心为最小堆（`PriorityQueue`），与原版 `heapq` 一致，复杂度 `O(log n)`。
- 回调分发时将 `callbacks=null` 可避免并发修改，提高稳定性；失败事件异常传播在 Java 中为 `RuntimeException` 包装，与原版类似。
- 进程使用虚拟线程提供“阻塞等待”语义，对比 Python 生成器有额外线程调度成本；在多数仿真场景下影响有限，但极端高并发场景下需评估（可切换到状态机式实现以消除线程开销）。

## 后续优化建议
- 引入 `JMH` 并增加：事件调度微基准、条件事件构建、资源队列触发性能曲线。
- 提供“无虚拟线程”的 `Process` 状态机实现以供对比，评估两种方案在不同工作负载下的优势。
- 开启 `-XX:+UseNUMA` 与 `-XX:+UseStringDeduplication` 对大型仿真模型进行进一步优化与调优。